{
  "summary": {
    "total_tests": 25,
    "passed_tests": 7,
    "failed_tests": 18,
    "success_rate": 28.000000000000004,
    "test_timestamp": "2025-08-17T23:32:46.139642",
    "registration_service_url": "http://localhost:8004",
    "main_backend_url": "https://offline-inspector-1.preview.emergentagent.com"
  },
  "test_results": [
    {
      "test": "Service Health Check",
      "success": true,
      "message": "Service healthy: healthy",
      "timestamp": "2025-08-17T23:32:44.794465",
      "details": {
        "database": "connected",
        "events": "connected",
        "dependencies": true,
        "configuration": {
          "min_age_provisional": 16.5,
          "min_age_class_b": 17,
          "min_age_class_c_ppv": 20,
          "weight_threshold_class_c": 7000,
          "max_document_size_mb": 5,
          "environment": "development"
        }
      }
    },
    {
      "test": "Configuration Endpoint",
      "success": true,
      "message": "Configuration retrieved successfully",
      "timestamp": "2025-08-17T23:32:44.796405",
      "details": {
        "min_age_provisional": 16.5,
        "min_age_class_b": 17,
        "min_age_class_c_ppv": 20,
        "weight_threshold_class_c": 7000,
        "document_formats": {
          "photo": [
            "jpeg",
            "jpg",
            "png"
          ],
          "id_proof": [
            "jpeg",
            "jpg",
            "png",
            "pdf"
          ],
          "medical": [
            "pdf"
          ],
          "other": [
            "pdf"
          ]
        }
      }
    },
    {
      "test": "Events Status Endpoint",
      "success": true,
      "message": "Events status retrieved successfully",
      "timestamp": "2025-08-17T23:32:44.797915",
      "details": {
        "event_service_connected": false,
        "fallback_events_count": 0,
        "has_fallback_events": false
      }
    },
    {
      "test": "Authentication - Missing Token",
      "success": true,
      "message": "Missing authorization properly rejected",
      "timestamp": "2025-08-17T23:32:44.799896",
      "details": {
        "status": 401
      }
    },
    {
      "test": "Authentication - Invalid Token Format",
      "success": true,
      "message": "Invalid token format properly rejected",
      "timestamp": "2025-08-17T23:32:44.801764",
      "details": {
        "status": 401
      }
    },
    {
      "test": "Direct Registration API - Class B Success",
      "success": false,
      "message": "Registration failed: External validation failed",
      "timestamp": "2025-08-17T23:32:44.880001",
      "details": {
        "success": false,
        "registration": null,
        "message": "External validation failed",
        "validation_errors": [
          "Failed to validate booking: HTTP 503",
          "Failed to validate receipt: HTTP 503"
        ],
        "driver_record_id": null
      }
    },
    {
      "test": "Age Validation - Provisional - Valid Age (16.5+)",
      "success": false,
      "message": "Expected success but got failure: External validation failed",
      "timestamp": "2025-08-17T23:32:44.962420",
      "details": {
        "success": false,
        "registration": null,
        "message": "External validation failed",
        "validation_errors": [
          "Failed to validate booking: HTTP 503",
          "Failed to validate receipt: HTTP 503"
        ],
        "driver_record_id": null
      }
    },
    {
      "test": "Age Validation - Provisional - Invalid Age (<16.5)",
      "success": false,
      "message": "Expected 400/422 but got 200",
      "timestamp": "2025-08-17T23:32:45.038079",
      "details": {
        "response": "{\"success\":false,\"registration\":null,\"message\":\"External validation failed\",\"validation_errors\":[\"Failed to validate booking: HTTP 503\",\"Failed to validate receipt: HTTP 503\"],\"driver_record_id\":null}"
      }
    },
    {
      "test": "Age Validation - Class B - Valid Age (17+)",
      "success": false,
      "message": "Expected success but got failure: External validation failed",
      "timestamp": "2025-08-17T23:32:45.114686",
      "details": {
        "success": false,
        "registration": null,
        "message": "External validation failed",
        "validation_errors": [
          "Failed to validate booking: HTTP 503",
          "Failed to validate receipt: HTTP 503"
        ],
        "driver_record_id": null
      }
    },
    {
      "test": "Age Validation - Class B - Invalid Age (<17)",
      "success": false,
      "message": "Expected 400/422 but got 200",
      "timestamp": "2025-08-17T23:32:45.197264",
      "details": {
        "response": "{\"success\":false,\"registration\":null,\"message\":\"External validation failed\",\"validation_errors\":[\"Failed to validate booking: HTTP 503\",\"Failed to validate receipt: HTTP 503\"],\"driver_record_id\":null}"
      }
    },
    {
      "test": "Age Validation - Class C - Valid Age (20+)",
      "success": false,
      "message": "Expected success but got failure: External validation failed",
      "timestamp": "2025-08-17T23:32:45.274421",
      "details": {
        "success": false,
        "registration": null,
        "message": "External validation failed",
        "validation_errors": [
          "Failed to validate booking: HTTP 503",
          "Failed to validate receipt: HTTP 503"
        ],
        "driver_record_id": null
      }
    },
    {
      "test": "Age Validation - Class C - Invalid Age (<20)",
      "success": false,
      "message": "Expected 400/422 but got 200",
      "timestamp": "2025-08-17T23:32:45.349042",
      "details": {
        "response": "{\"success\":false,\"registration\":null,\"message\":\"External validation failed\",\"validation_errors\":[\"Failed to validate booking: HTTP 503\",\"Failed to validate receipt: HTTP 503\"],\"driver_record_id\":null}"
      }
    },
    {
      "test": "Medical Certificate - Provisional - MC1 Required",
      "success": false,
      "message": "Expected success but got failure: External validation failed",
      "timestamp": "2025-08-17T23:32:45.435047",
      "details": {
        "success": false,
        "registration": null,
        "message": "External validation failed",
        "validation_errors": [
          "Failed to validate booking: HTTP 503",
          "Failed to validate receipt: HTTP 503"
        ],
        "driver_record_id": null
      }
    },
    {
      "test": "Medical Certificate - Provisional - Missing MC1",
      "success": false,
      "message": "Expected 400/422 but got 200",
      "timestamp": "2025-08-17T23:32:45.509944",
      "details": {
        "response": "{\"success\":false,\"registration\":null,\"message\":\"External validation failed\",\"validation_errors\":[\"Failed to validate booking: HTTP 503\",\"Failed to validate receipt: HTTP 503\"],\"driver_record_id\":null}"
      }
    },
    {
      "test": "Medical Certificate - Class C - MC2 Required",
      "success": false,
      "message": "Expected success but got failure: External validation failed",
      "timestamp": "2025-08-17T23:32:45.581901",
      "details": {
        "success": false,
        "registration": null,
        "message": "External validation failed",
        "validation_errors": [
          "Failed to validate booking: HTTP 503",
          "Failed to validate receipt: HTTP 503"
        ],
        "driver_record_id": null
      }
    },
    {
      "test": "Medical Certificate - Class C - Missing MC2",
      "success": false,
      "message": "Expected 400/422 but got 200",
      "timestamp": "2025-08-17T23:32:45.669534",
      "details": {
        "response": "{\"success\":false,\"registration\":null,\"message\":\"External validation failed\",\"validation_errors\":[\"Failed to validate booking: HTTP 503\",\"Failed to validate receipt: HTTP 503\"],\"driver_record_id\":null}"
      }
    },
    {
      "test": "Medical Certificate - Class B - No MC Required",
      "success": false,
      "message": "Expected success but got failure: External validation failed",
      "timestamp": "2025-08-17T23:32:45.746313",
      "details": {
        "success": false,
        "registration": null,
        "message": "External validation failed",
        "validation_errors": [
          "Failed to validate booking: HTTP 503",
          "Failed to validate receipt: HTTP 503"
        ],
        "driver_record_id": null
      }
    },
    {
      "test": "Document Validation - Missing Required Documents",
      "success": true,
      "message": "Missing required documents properly rejected",
      "timestamp": "2025-08-17T23:32:45.748415",
      "details": {
        "status": 422
      }
    },
    {
      "test": "Document Validation - Oversized Document",
      "success": false,
      "message": "Expected 400/422, got 200",
      "timestamp": "2025-08-17T23:32:45.870128",
      "details": {
        "response": "{\"success\":false,\"registration\":null,\"message\":\"External validation failed\",\"validation_errors\":[\"Failed to validate booking: HTTP 503\",\"Failed to validate receipt: HTTP 503\"],\"driver_record_id\":null}"
      }
    },
    {
      "test": "External Service Validation",
      "success": true,
      "message": "External service validation handled gracefully with status 200",
      "timestamp": "2025-08-17T23:32:45.958926",
      "details": {
        "status": 200,
        "success": false,
        "message": "External validation failed"
      }
    },
    {
      "test": "Manager Override Functionality",
      "success": false,
      "message": "Manager override failed: External validation failed",
      "timestamp": "2025-08-17T23:32:46.034212",
      "details": {
        "success": false,
        "registration": null,
        "message": "External validation failed",
        "validation_errors": [
          "Failed to validate booking: HTTP 503",
          "Failed to validate receipt: HTTP 503"
        ],
        "driver_record_id": null
      }
    },
    {
      "test": "Registration Retrieval",
      "success": false,
      "message": "No registration ID provided",
      "timestamp": "2025-08-17T23:32:46.034275",
      "details": {}
    },
    {
      "test": "Main Backend Integration - Health Check",
      "success": false,
      "message": "Health check failed with status 502",
      "timestamp": "2025-08-17T23:32:46.125235",
      "details": {
        "response": ""
      }
    },
    {
      "test": "Main Backend Integration - Dependencies Check",
      "success": false,
      "message": "Dependencies check failed with status 502",
      "timestamp": "2025-08-17T23:32:46.132270",
      "details": {
        "response": ""
      }
    },
    {
      "test": "Main Backend Integration - Events Status",
      "success": false,
      "message": "Events status failed with status 502",
      "timestamp": "2025-08-17T23:32:46.139240",
      "details": {
        "response": ""
      }
    }
  ],
  "created_registrations": []
}