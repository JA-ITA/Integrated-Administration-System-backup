{
  "summary": {
    "total_tests": 16,
    "passed_tests": 6,
    "failed_tests": 10,
    "success_rate": 37.5,
    "test_timestamp": "2025-08-17T22:50:08.978675",
    "main_backend_url": "https://cranky-tharp.preview.emergentagent.com",
    "receipt_service_url": "http://localhost:8003"
  },
  "test_results": [
    {
      "test": "Receipt Service Health Check",
      "success": true,
      "message": "Service healthy: healthy",
      "timestamp": "2025-08-17T22:50:08.741459",
      "details": {
        "status": "healthy",
        "service": "ITADIAS Receipt Microservice",
        "version": "1.0.0",
        "database": "connected",
        "events": "connected",
        "configuration": {
          "max_receipt_age_days": 365,
          "valid_locations_count": 9,
          "environment": "development"
        }
      }
    },
    {
      "test": "Main Backend Receipt Integration Health",
      "success": true,
      "message": "Integration healthy: healthy",
      "timestamp": "2025-08-17T22:50:08.840103",
      "details": {
        "receipt_service": "healthy",
        "status": {
          "status": "healthy",
          "service": "ITADIAS Receipt Microservice",
          "version": "1.0.0",
          "database": "connected",
          "events": "connected",
          "configuration": {
            "max_receipt_age_days": 365,
            "valid_locations_count": 9,
            "environment": "development"
          }
        }
      }
    },
    {
      "test": "Valid Receipt Validation - Valid Receipt - TAJ Online",
      "success": false,
      "message": "Expected 200, got 409",
      "timestamp": "2025-08-17T22:50:08.846334",
      "details": {
        "response": "{\"success\":false,\"receipt_no\":\"ABC123DEF890\",\"message\":\"Receipt has already been used\",\"receipt\":null,\"validation_timestamp\":\"2025-08-17T22:50:08.845228+00:00\"}"
      }
    },
    {
      "test": "Valid Receipt Validation - Valid Receipt - TAJ Mumbai Office",
      "success": false,
      "message": "Expected 200, got 409",
      "timestamp": "2025-08-17T22:50:08.851734",
      "details": {
        "response": "{\"success\":false,\"receipt_no\":\"XYZ98765432\",\"message\":\"Receipt has already been used\",\"receipt\":null,\"validation_timestamp\":\"2025-08-17T22:50:08.850668+00:00\"}"
      }
    },
    {
      "test": "Valid Receipt Validation - Valid Receipt - Recent Date",
      "success": false,
      "message": "Expected 200, got 409",
      "timestamp": "2025-08-17T22:50:08.856949",
      "details": {
        "response": "{\"success\":false,\"receipt_no\":\"RECENT123456\",\"message\":\"Receipt has already been used\",\"receipt\":null,\"validation_timestamp\":\"2025-08-17T22:50:08.855941+00:00\"}"
      }
    },
    {
      "test": "Invalid Receipt Validation - Invalid Receipt Number Format",
      "success": false,
      "message": "Expected 400, got 422",
      "timestamp": "2025-08-17T22:50:08.859780",
      "details": {
        "response_data": {
          "detail": [
            {
              "type": "string_too_short",
              "loc": [
                "body",
                "receipt_no"
              ],
              "msg": "String should have at least 8 characters",
              "input": "abc123",
              "ctx": {
                "min_length": 8
              },
              "url": "https://errors.pydantic.dev/2.5/v/string_too_short"
            }
          ]
        }
      }
    },
    {
      "test": "Invalid Receipt Validation - Receipt Number Too Short",
      "success": false,
      "message": "Expected 400, got 422",
      "timestamp": "2025-08-17T22:50:08.862506",
      "details": {
        "response_data": {
          "detail": [
            {
              "type": "string_too_short",
              "loc": [
                "body",
                "receipt_no"
              ],
              "msg": "String should have at least 8 characters",
              "input": "ABC123",
              "ctx": {
                "min_length": 8
              },
              "url": "https://errors.pydantic.dev/2.5/v/string_too_short"
            }
          ]
        }
      }
    },
    {
      "test": "Invalid Receipt Validation - Invalid Location",
      "success": false,
      "message": "Expected 400, got 422",
      "timestamp": "2025-08-17T22:50:08.865157",
      "details": {
        "response_data": {
          "detail": [
            {
              "type": "value_error",
              "loc": [
                "body",
                "location"
              ],
              "msg": "Value error, Invalid location. Must be one of: TAJ Online, TAJ Mumbai Office, TAJ Delhi Office, TAJ Bangalore Office, TAJ Chennai Office, TAJ Kolkata Office, TAJ Pune Office, TAJ Hyderabad Office, TAJ Ahmedabad Office",
              "input": "Invalid Office",
              "ctx": {
                "error": {}
              },
              "url": "https://errors.pydantic.dev/2.5/v/value_error"
            }
          ]
        }
      }
    },
    {
      "test": "Invalid Receipt Validation - Old Receipt Date",
      "success": false,
      "message": "Expected 400, got 422",
      "timestamp": "2025-08-17T22:50:08.868034",
      "details": {
        "response_data": {
          "detail": [
            {
              "type": "value_error",
              "loc": [
                "body",
                "issue_date"
              ],
              "msg": "Value error, Receipt is too old. Maximum age is 365 days",
              "input": "2023-01-01T00:00:00Z",
              "ctx": {
                "error": {}
              },
              "url": "https://errors.pydantic.dev/2.5/v/value_error"
            }
          ]
        }
      }
    },
    {
      "test": "Duplicate Receipt Validation",
      "success": false,
      "message": "First receipt validation failed with status 409",
      "timestamp": "2025-08-17T22:50:08.873043",
      "details": {
        "response": "{\"success\":false,\"receipt_no\":\"DUPLICATE123\",\"message\":\"Receipt has already been used\",\"receipt\":null,\"validation_timestamp\":\"2025-08-17T22:50:08.872122+00:00\"}"
      }
    },
    {
      "test": "Main Backend Receipt Validation",
      "success": false,
      "message": "Main backend validation returned success=false: No message",
      "timestamp": "2025-08-17T22:50:08.918692",
      "details": {
        "success": false,
        "error": "Receipt service unavailable"
      }
    },
    {
      "test": "Get Receipt Details",
      "success": false,
      "message": "No validated receipts available for testing",
      "timestamp": "2025-08-17T22:50:08.918755",
      "details": {}
    },
    {
      "test": "Receipt Statistics - Main Backend",
      "success": true,
      "message": "Statistics retrieved successfully",
      "timestamp": "2025-08-17T22:50:08.965658",
      "details": {
        "statistics": {
          "found": false,
          "receipt": null
        }
      }
    },
    {
      "test": "Receipt Statistics - Direct Service",
      "success": true,
      "message": "Statistics retrieved from service: success",
      "timestamp": "2025-08-17T22:50:08.974094",
      "details": {
        "statistics": {
          "total_receipts": 5,
          "used_receipts": 5,
          "unused_receipts": 0,
          "usage_rate": 100.0
        }
      }
    },
    {
      "test": "Error Handling - Malformed JSON",
      "success": true,
      "message": "Malformed JSON properly rejected",
      "timestamp": "2025-08-17T22:50:08.975766",
      "details": {
        "status": 422
      }
    },
    {
      "test": "Error Handling - Missing Fields",
      "success": true,
      "message": "Missing required fields properly rejected",
      "timestamp": "2025-08-17T22:50:08.978411",
      "details": {
        "status": 422
      }
    }
  ],
  "validated_receipts": []
}